# Cursor×Python×GitHub 学習ガイド（Mac 版）

## AI とプログラミングを始めよう

### 学習のゴール

プログラミングが全く初めてでも大丈夫です。この学習コンテンツでは、以下のことを体験していきます。

1. **AI と会話しながらコードを書く** - 「これがしたい」と伝えるだけで OK
2. **アプリを作る楽しさを知る** - 商品を登録して見る簡単な Web アプリを作ります
3. **プロのような開発方法を学ぶ** - GitHub でプロジェクト管理をします
4. **クラウド環境で動くアプリを作る** - 最後は Google Cloud で公開します

AI が先生役になってくれるので、専門用語がわからなくても大丈夫。困ったらその場で聞けます。

---

## タイムスケジュール（1.5 時間）

| 時間 | 内容 | 何をするの？ | AI が手伝ってくれること |
|------|------|----------|----------------|
| 0:00-0:25 | 道具の準備 | プログラミングするためのソフトをインストール | エラーが出ても AI が解決方法を教えてくれる |
| 0:25-0:35 | AI との会話練習 | 「これがしたい」を AI に伝える練習 | 専門用語を使わずに説明してくれる |
| 0:35-0:50 | 作業の整理 | 大きな仕事を小さな作業に分ける | AI が自動で作業リストを作ってくれる |
| 0:50-1:10 | API を作る | データを登録・取得する仕組みを作る | AI が間違いのないコードを書いてくれる |
| 1:10-1:25 | 画面を作る | 商品を登録する画面を作る | AI が見た目も機能も作ってくれる |
| 1:25-1:35 | クラウド公開 | 作ったアプリをインターネット経由で使えるようにする | AI がクラウド設定を自動でやってくれる |
| 1:35-1:40 | 完成お披露目 | みんなで作ったアプリを確認 | 本格的な Web アプリが完成！ |

---

## Part 1：環境構築（25 分）

### まずは道具の準備をしましょう

プログラミングを始める前に、必要なソフトをインストールします。
全てコピー＆ペーストで進められるので、プログラミング初心者でも安心してください。

#### 何をインストールするの？

- **Volta**：Node.js とJavaScriptツールの自動管理ツール（プロジェクトごとに最適なバージョンを自動選択）
- **Cursor**：AI と会話しながらコードが書けるエディタ
- **uv**：Python の道具を管理するツール（必要なプログラムを自動で探して入れてくれる便利な管理ツール）
- **GitHub CLI（gh）**：パソコンと GitHub をつなぐツール（パソコンから GitHub の作業を実行できるコマンドラインツール）
  - **GitHub って何？**：プログラマーが作品を保存・共有するクラウドサービス（プログラムのコードを管理・共有するためのプラットフォーム）
- **Google Cloud CLI（gcloud）**：Google Cloud を操作するツール（Cloud Run へのアプリ公開で必要なコマンドラインツール）

### 1.1 Volta のインストール（Node.js 管理ツール）

#### なぜ Volta なの？

2025年の最新トレンドとして、**Volta**（ボルタ）が推奨されています。

**Volta の特徴：**

- **自動切り替え**：プロジェクトに入ると自動的に適切な Node.js バージョンに切り替え
- **チーム統一**：みんなが同じバージョンを使うので安心
- **高速動作**：Rust 製で非常に高速
- **全ツール管理**：Node.js、npm、Yarn をまとめて管理

#### インストール方法（3 分）

**システムのターミナル**（Cursor はまだ起動していません）で以下を実行します。

```bash
curl https://get.volta.sh | bash
```

#### 動作確認

新しいターミナルを開いて確認します。

```bash
volta --version
```

`1.x.x` のような表示が出れば成功です。

#### Node.js のインストール

```bash
# 最新の長期サポート版（推奨）
volta install node

# 確認
node --version
npm --version
```

### 1.2 Cursor のインストール

#### インストール手順（5 分）

##### Step 1：ダウンロード

1. ブラウザで [cursor.com](https://cursor.com) を開く
2. 「**ダウンロード MacOS**」ボタンをクリック
3. ダウンロードが始まります（しばらく待ってください）

##### Step 2：インストール

1. ダウンロードフォルダにある「**Cursor-xxx.dmg**」をダブルクリック
2. 開いたウィンドウで、Cursor のアイコンを「**Applications**」フォルダにドラッグ
3. これでインストール完了です！

##### Step 3：起動

1. Launchpad を開く
2. 「**Cursor**」を見つけてクリック

#### 初期設定（10分）

初回起動時に設定を行います。ゆっくりひとつずつ進めていきましょう。

##### Step 1：ログイン

- 「**Sign in with GitHub**」をクリック
- GitHub アカウントでログイン（ない場合はその場で作成できます）

##### Step 2：基本設定

1. テーマ選択：
   - Cursor Dark、Cursor Dark Midnight、Cursor Dark High Contrast から選択
   - 「**Contineue**」をクリック
2. キーバインディング選択：
   - VS Code（デフォルト）、Vim、Emacs、Sublime Text から選択
   - 「**Continue**」をクリック
3. データ共有の確認：
   - チェックボックスを ON にして「**Continue**」をクリック
   - **重要**：後でプライバシー設定を変更します
4. Review Settings 画面：
   - **Language for AI**：「**Japanese**」を選択（デフォルトは Auto）
   - **Open from Terminal**：「**Install**」ボタンをクリック（デフォルトの「**cursor command**」が選択されている状態で）
   - 「**Continue**」をクリック

##### Step 3：プライバシー設定（重要）

1. 右上の歯車アイコンをクリック
2. 「**General**」→「**Privacy**」
3. 「**Privacy Mode**」を選択
   - これで、あなたのコードが学習に使われません

##### Step 4：日本語化

1. `Cmd` + `Shift` + `X` を押す（拡張機能を開く）
2. 検索欄に「`Japanese`」と入力
3. 「**Japanese Language Pack for Visual Studio Code**」の「**Install**」ボタンをクリック
4. 左下に表示される「**Change Language and Restart**」をクリック

##### Step 5：設定完了

- Cursor Settings タブの「×」をクリックして閉じる

【豆知識】

- Cursor Pro の**14 日間無料トライアル**が使えます
- 設定は後からいつでも変更できるので安心してください
- VS Code を使ったことがある方は、設定を引き継げます

### 1.3 開発ツールのインストール

#### Cursor内のターミナルを開く

- Cursor で `Ctrl` + `Shift` + `~` を押す
- 画面下にターミナルが表示されます
- **これ以降、すべてのコマンドは Cursor 内のターミナルで実行します**

#### uv のインストール

##### GUI操作での確認

1. **コマンドパレット**（`Cmd` + `Shift` + `P`）を開く
2. 「**Terminal: Create New Terminal**」と入力してEnter
3. Cursor内のターミナルが開きます

##### インストール実行

**Cursor 内のターミナル**で以下を実行します。

```bash
curl -LsSf https://astral.sh/uv/install.sh | sh
```

#### GitHub CLI のインストール

**Cursor 内のターミナル**で以下を実行します。

```bash
# Homebrewが未インストールの場合はまずこちら
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

# GitHub CLIをインストール
brew install gh
```

**ヒント**：Cursor の **Source Control** パネル（サイドバーのGitアイコン）からもGit操作が可能です。

#### Google Cloud CLI（gcloud）のインストール

Cloud Run へのデプロイで必要になるため、事前にインストールしておきます。

**Cursor 内のターミナル**で以下を実行します。

```bash
# Google Cloud CLI をインストール
brew install --cask google-cloud-sdk

# インストール確認
gcloud version
```

**結果の確認**：

- `Google Cloud SDK x.x.x` のような表示が出れば OK
- 初回起動時は初期設定画面が表示されることがあります（後で設定するので、今はスキップして OK）

##### ツールの動作確認

すべてのツールがインストールされたか確認します。

```bash
# uv の確認
uv --version

# GitHub CLI の確認
gh --version

# Google Cloud CLI の確認
gcloud --version
```

- `uv x.x.x` と表示されれば uv は OK
- `gh version x.x.x` のような表示が出れば GitHub CLI は OK
- `Google Cloud SDK x.x.x` のような表示が出れば gcloud は OK

### 1.4 プロジェクトの準備（10 分）

#### 今から何をするの？

「プロジェクトのひな形」をダウンロードして、自分専用にします。
必要なファイルがすべて揃った「スターターキット」を受け取るイメージです。

#### Step 1：テンプレートを開く

ブラウザで以下のリンクを開いてください：

```text
https://github.com/asakaguchi/cursor-workshop-template
```

#### Step 2：自分のプロジェクトを作る

1. 青色の「**Use this template**」ボタンをクリック
2. 「**Create a new repository**」を選択
3. **Repository name**に「`my-cursor-workshop`」と入力
4. 「**Create repository**」をクリック

#### Step 3：Cursor でプロジェクトを開く

1. `Cmd + Shift + P` でコマンドパレットを開く
2. 「**Git: Clone**」と入力して `Enter`
3. 「**GitHub から複製**」を選択
4. 「**拡張機能 'GitHub' が GitHub を使用してサインインしようとしています。**」のダイアログで、「**許可**」をクリック
5. 「**コピーして GitHub に進む**」をクリック
6. 自身の GitHub アカウントで認証（ブラウザで認証コードをペースト）
7. 「**Authorize Visual Studio Code**」で「**Authorize Visual-Studio-Code**」をクリック
8. Cursor に戻り、作成したリポジトリ（`my-cursor-workshop`）を選択
9. 保存先フォルダを選択して「**リポジトリの宛先として選択**」をクリック（「**Projects**」フォルダーの作成を推奨）

### 1.5 MCP サーバーの有効化

画面左下に以下の通知が表示されたら、それぞれ「**Enable**」ボタンをクリック：

- 「**New MCP Server detected: cloud-run**」
- 「**New MCP Server detected: context7**」
- 「**New MCP Server detected: playwright**」

### 1.6 Python 環境のセットアップ（5 分）

#### Python 環境の準備

プロジェクト専用の「作業環境」を作ります。
他のプロジェクトと混ざらないように、専用の環境を用意するイメージです。

**重要**: uv が Python のバージョン管理も含めて全て自動で処理するため、事前の Python インストールは不要です。

#### Cursorでターミナルを開く

**重要**: まず Cursor で `Ctrl + Shift + ~` を押してターミナルを開いてください。これ以降のコマンドは全て Cursor 内のターミナルで実行します。

##### 環境をセットアップ

```bash
# プロジェクトに必要な道具を全部そろえる
uv sync

# 各サブディレクトリでも個別にセットアップ
cd api && uv sync && cd ..
cd ui && uv sync && cd ..
```

初回は 1-2 分かかります。uv が自動的に以下を実行します。

- Python 3.12 の自動インストール（必要な場合）
- 仮想環境（プロジェクト専用の Python 環境）の作成
- 全依存関係のインストール

##### 品質チェックツールのセットアップ

```bash
# コードの品質をチェックする仕組みを準備
uv run --extra dev pre-commit install
```

### 1.7 GitHub CLI の認証設定（5 分）

#### GitHub 認証の概要

パソコンと GitHub を連携させます。
これにより、後で作業リストを自動作成できるようになります。

##### 認証の手順

**Cursor 内のターミナル**で以下を実行します。

```bash
# インストール確認
gh --version

# 認証開始
gh auth login
```

##### 質問が出てきたら、以下のように答える

1. **What account do you want to log into?**
   →「**GitHub.com**」を選んで `Enter` を押す
2. **What is your preferred protocol for Git operations?**
   →「**HTTPS**」を選んで `Enter` を押す
3. **Authenticate Git with your GitHub credentials?**
   →そのまま `Enter` を押す
4. **How would you like to authenticate GitHub CLI?**
   →「**Login with a web browser**」を選んで `Enter` を押す
5. **Press Enter to open github.com in your browser...**
   → `Enter` を押す
6. **ブラウザが開いたら：**
   - 表示されたコード（8 桁の英数字）をコピー
   - GitHub にログインして、コードを入力
   - 「**Authorize**」をクリック

#### 成功したら

「**Authentication complete!**」のようなメッセージが表示されます。

#### 豆知識

- この設定により、後で AI が自動的に作業リストを作ってくれます
- 今回限りの設定なので、次回からは不要です

### ローカル Python 環境の利点

- 高速な開発サイクル（ファイル変更が即座に反映）
- シンプルなセットアップ
- IDE やエディタとのスムーズな連携
- Cloud Run へのデプロイも MCP 経由で簡単

テンプレートリポジトリを使うことで、必要なファイルがすべて揃った状態から始められます。uv を使用することで、Python の依存関係が高速にインストールされます。

### できたこと

- 開発環境の構築が完了
- AI を活用した開発環境の準備が整った

---

## Part 2：Human-in-the-Loop 開発を体験（10分）

### AI と実際に話してみましょう

理論は後回し。まずは触って体験することから始めます。

### 2.1 Cursor の AI 機能を体験しよう

#### 実際に AI と話してみましょう

##### Step 1：チャットを開く

デフォルトでチャットパネルが画面右側に表示されています。もし、表示されていない場合は、以下の手順を実行してください。

- `Cmd` + `I` を押す
- 画面右側にチャットパネルが表示されます

##### Step 2：AIモデルの選択

- チャット欄の下部にある「**Auto**」をクリック
- 表示されたメニューで「**Auto**」のスイッチを**オフ**にする
- モデル一覧から「**gemini-2.5-pro**」を選択
  - これで、Googleの最新AIモデルを使用できます

##### Step 3：最初の質問とプロジェクトポリシーの確認

以下をコピー&ペーストして送信してみてください。

```text
@requirements.md @CLAUDE.md を読んで、どんなアプリを作るのか教えてください。
初心者にもわかりやすく説明してください。
```

##### Step 4：追加で質問してみる

AI が答えてくれたら、わからない言葉について聞いてみましょう。

```text
API って何ですか？小学生でもわかるように説明してください。
```

#### AI との上手な話し方

- 「○○がわからない」
- 「もっと簡単に説明して」
- 「具体例を教えて」

恥ずかしがらずに何でも質問して OK！

### 2.2 プロジェクトのルールを確認

#### 「お約束ごと」を確認しましょう

このプロジェクトには「こうやって作ってね」というルールが書かれています。
AI に聞いてみましょう。

```text
.cursor/rules/ にあるファイルを見て、このプロジェクトの開発ルールを
初心者向けに箇条書きでまとめてください。
```

#### なぜルールがあるの？

一定の品質基準を保つためです。

- **きれいなコード**が書ける
- **間違いが少なくなる**
- **他の人も理解しやすい**

AI は自動的にこのルールに従ってくれるので、初心者でもプロ品質のコードが書けます！

---

## Part 3：API開発タスクの計画（15 分）

API開発の作業を整理して、AI に手伝ってもらいましょう！
作業を適切な粒度に分けることで、確実に進められます。

### 3.1 作業の分解をお願いしよう

#### なぜ作業を分けるの？

大きな作業を小さく分けることで以下のメリットがあります。

- **進捗がわかりやすい**
- **達成感が得られる**
- **困ったときに助けを求めやすい**

#### AI に作業分解をお願い

チャットで以下を送信してください。

```text
@requirements.md を確認して、API開発のタスクを分解してください。
```

AI が自動的に Issue 駆動開発とTDDのルールに従って、適切なタスクを作成してくれます。

### 3.2 作業リストを GitHub に保存

作業リストを GitHub に保存しましょう。

タスクの内容を確認して、良さそうだったら、

```text
ok
```

と入力するだけ！

**AI がやってくれること**
この一言で、AI が以下を自動実行します。

- GitHub に作業リスト（Issue）を作成
- 優先順位を設定
- 進捗管理の準備完了

#### 重要：各Issueの作成時に確認が必要です

- AI が各 Issue を作成する前に、内容を表示して確認を求めます
- 画面に「**Run**」ボタンが表示されたら、内容を確認してクリックしてください
- この確認は各 Issue（タスク）ごとに必要です（例：5 つのタスクなら 5 回クリック）

### 3.3 作業リストを確認

#### GitHub で作業リストを見てみましょう

**Cursor 内のターミナル**で以下を実行します。

```bash
gh repo view --web
```

**ブラウザが開いたら：**

1. 「**Issues**」タブをクリック
2. 作られた作業リストが表示されます

#### 作成されるIssueの例

AIによって以下のようなIssueが自動作成されます：

- **Task 1**: プロジェクトの準備と土台作り (#1)
- **Task 2**: APIの動作確認機能（ヘルスチェック）を作る (#2)  
- **Task 3**: 商品データの「設計図」を作る (#3)
- **Task 4**: 新しい商品を登録する機能を作る (#4)
- **Task 5**: 特定の商品をIDで探す機能を作る (#5)

#### 各Issueの詳細

各 Issue をクリックすると、具体的な作業内容が表示されます。

- **概要**: そのタスクで何をするかの説明
- **作業内容**: 具体的にやることのチェックリスト
- **技術的な詳細**: 作成するファイルや実装する機能

**番号の意味**
各作業には番号（#1、#2 など）が付いています。
これは「作業の識別番号」で、後で AI に「Issue #1 を開始してください」と指示する際に使用します。

### 作業リスト作成の成果

- 作業が整理されました
- 進捗が見えるようになりました
- プロ仕様のプロジェクト管理環境が完成！

---

## Part 4：TDD で API 開発（20 分）

いよいよプログラミング開始！
AI が「テスト→実装→改善」のサイクルを高速で回してくれます。

### 4.1 最初の作業開始

#### さあ、最初の作業を始めましょう

チャットで AI に伝えてください。

```text
Issue #1 を開始してください
```

#### 重要：作業開始時も確認が必要です

- AIが「Issue #1の開発を開始します」と言って、開発ブランチの作成を提案します
- 画面に「**Run**」ボタンが表示されたら、内容を確認してクリックしてください
- この後も、各作業ステップごとに同様の確認が求められます

#### AI がやってくれること

1. **作業用のブランチ作成**（作業用の独立した環境を用意）
2. **必要なファイル作成**（設計図を作成）
3. **テストコード作成**（品質チェックの準備）

### 4.2 AI との対話パターンを理解しよう

#### 開発中に出てくる確認場面

AI が作業を進める中で、以下のような確認を求めてきます。適切に対応することで、スムーズに開発が進みます。

##### パターン 1：「**Run**」ボタンが表示される場面

**場面例**：

- AI が「Issue #1 の開発を開始します」と提案
- AI がファイル作成や修正を提案
- AI がテスト実行を提案

**対応方法**：

1. 提案内容を確認する
2. 問題なければ「**Run**」ボタンをクリック
3. エラーや問題があれば後述の対処法を使用

##### パターン 2：「**Accept**」ボタンが表示される場面

**場面例**：

- AI がファイルの削除を提案（例：test_placeholder.py の削除）
- AI がファイルの変更を提案
- AI がコードの修正を提案

**対応方法**：

1. 提案内容を慎重に確認する
2. 適切な変更であれば「**Accept**」ボタンをクリック
3. 不適切な変更（既存設定の削除など）であれば「**Reject**」ボタンをクリック

**注意点**：

- プレースホルダーファイル（test_placeholder.py など）の削除は通常問題ありません
- pyproject.toml や重要な設定ファイルの変更提案は慎重に判断してください

##### パターン 3：ファイル作成・編集提案の承認

**場面例**：

- AI がチャットパネル内でファイル作成を提案
- エディタ上でファイル内容の変更が表示される
- 新しいテストファイルやコードファイルの内容がプレビュー表示される

**対応方法（2つの方法があります）**：

##### 方法1：チャットパネルの「✓」「×」アイコン

1. チャットパネル内の提案内容を確認
2. 内容が適切であれば「**✓**」アイコンをクリック（Accept）
3. 問題がある場合は「**×**」アイコンをクリック（Reject）

##### 方法2：エディタ下部の「Accept file」ボタン

1. エディタ上で変更内容を詳細確認
2. 内容が適切であれば「**Accept file**」ボタンをクリック
3. 問題がある場合は「**Reject file**」ボタンをクリック

**どちらを使ってもOK**：両方とも同じ結果になります

##### 複数ファイルの場合

1. 「**Review next file**」ボタンが表示される
2. クリックして次のファイルを確認
3. 各ファイルで「**Accept file**」「**Reject file**」を選択
4. 全ファイルを順番にレビュー

**確認ポイント**：

- ファイルパスと名前が正しいか
- インポート文や依存関係が適切か
- テストコードの場合、テスト内容が要件に合っているか
- 既存コードとの整合性が保たれているか

##### パターン 4：簡単な確認を求められる場面

**場面例**：

- 「これで進めていいですか？」
- 「次に○○を実装しますが、よろしいでしょうか？」
- 設計内容の確認後の進行許可

**対応方法**：

```text
ok
```

このように短く返答するだけで OK です。

##### パターン 5：選択肢を求められる場面

**場面例**：

- 「AとBどちらの方法で実装しますか？」
- 「ファイル名は○○でよろしいですか？」

**対応方法**：

```text
A で進めてください
```

または

```text
その名前で OK です
```

##### パターン 6：間違った方向に進む場面

**場面例**：

- pyproject.toml の大幅な変更を提案
- 既存の設定を削除しようとする
- プロジェクトルールに違反する提案

**対応方法**：

```text
STOP！既存の設定を変更しないでください。

このプロジェクトテンプレートには既に最適化された設定が含まれています。
pyproject.toml の既存設定をそのまま使用し、必要最小限の追加のみ行ってください。
```

#### 対話のコツ

1. **積極的に確認**：わからないことがあれば遠慮なく質問
2. **短く明確に**：「ok」「はい」「Aで」など簡潔に
3. **問題を感じたら即座にストップ**：「STOP」で止めて再指示

##### パターン 7：Issue完了とPR作成完了の報告

**場面例**：

- AI が「プルリクエストの作成が完了しました。」と報告
- 「Issue #X のすべての作業が完了です！」
- 「準備ができましたら、お声がけください。」

**ユーザー側の対応手順**：

1. **PR を確認する**
2. **PR をマージする**
3. **次の Issue へ進む指示**

   ```text
   PR を確認してマージしました。Issue #3 を開始してください。
   ```

**重要なポイント**：

- AI は PR 作成まで自動実行してくれる
- ユーザーは PR の内容確認とマージを担当
- 明確に次の Issue 番号を指定して進行指示

#### ファイルの置き場所

コードは `api/` フォルダに整理されます。

#### 見守ってください

AI が作業している様子をリアルタイムで見ることができます。

### 4.3 TDD の流れを体験

#### TDD（テスト駆動開発）って何？

品質を保証しながら開発を進める手法です。

#### プログラミングでの3ステップ

1. **Red**：「こうなってほしい」をテストで書く
2. **Green**：テストが通る最小限のコードを書く
3. **Refactor**：コードをより良く改善

#### 重要：API・UI開発ともにPlaywright MCPを併用

**このプロジェクトでは、すべてのTDD開発でPlaywright MCPを併用してください。**

- **API開発時**：pytestに加えてPlaywright MCPでブラウザからの動作確認
- **UI開発時**：Playwright MCPをメインテストツールとして使用
- **統合確認**：各段階でPlaywright MCPによる実際のブラウザテスト

AIに指示する際は以下のように伝えてください：

```text
Issue #X をTDDで開始してください。
すべてのテスト段階でPlaywright MCPも併用してください。
```

#### 観察ポイント

AI がこの 3 ステップを繰り返している様子を見てください。
最初は赤い文字（失敗）が、だんだん緑（成功）に変わります！

### 4.4 テストを動かしてみよう

#### 品質チェックを実行

**Cursor 内のターミナル**で以下のコマンドを実行してみてください。

```bash
# 全体的な品質チェック（ルートディレクトリから）
uv run pytest

# または個別にテスト
cd api && uv run pytest
cd ui && uv run pytest
```

#### 詳しく見たい場合

```bash
# 詳細な結果を表示
uv run pytest -v
```

#### 特定の部分だけチェック

```bash
# 特定のテストファイルのみ
uv run pytest tests/test_specific.py -v
```

#### 結果の見方

- **赤い文字**：まだ作成中（正常です！）
- **緑の文字**：完成して正常動作
- **FAILED**：何か問題があります
- **PASSED**：完璧に動作しています

#### 最初は赤くて当然

TDD では「まずテストを書いて失敗させる」ので、最初の赤は成功の証拠です！

### 4.5 作業完了の報告

#### 完成の確認ポイント

以下がすべて OK になったら完成です。

- **テストが全部緑色**になった
- **コードが期待通りに動く**
- **コードがきれいに整理**されている

#### AI に完了を報告

タスクが完了したら、チャットで伝えてください。

```text
Issue #1 が完了しました。PR を作成してください。
```

#### AI が最後の仕上げ

1. **コードを保存**（コミット：変更内容を記録）
2. **GitHub にアップロード**（プッシュ：リモートリポジトリに送信）
3. **レビュー依頼を作成**（プルリクエスト：コードレビューのための提案）

### Issue #1 の成果

- プロ品質のコードが完成
- チームレビューの準備完了
- 安全で確実な開発フロー体験

#### プルリクエストって何？

「この変更をマージ（統合）してもいいですか？」とチームに確認してもらう仕組みです。
今回は一人ですが、実際の開発では重要なステップです。

### 4.6 Issue 管理の確認と手動クローズ

#### Issue 状態の確認

作業完了後、Issue が適切に管理されているか GitHub で確認しましょう。

---

## Part 5：Web UI 開発（15分）

### 画面を作ってみましょう

AI がデザイナー＋エンジニアとして、画面の設計から実装まで担当してくれます。

#### API（データの仕組み）ができたら、次は画面作り

Streamlit という道具を使って、誰でも簡単に使える画面を作ります。

#### 画面で何ができるようになる？

- 商品名と値段を入力
- 登録ボタンをクリック
- 登録した商品を一覧で確認

### 5.1 画面の設計検討

#### AI をプロダクトマネージャーにしよう

AI に「どんな画面があると便利か」を検討してもらいましょう。

チャットで以下を送信：

```text
商品管理 API を使った Web 画面を、Streamlit で作りたいです。

あなたは経験豊富なプロダクトマネージャーとして、
どんな画面や機能があると便利か、アイデアを提案してください。

ユーザーは商品の在庫を管理する会社の担当者です。
初心者でも使いやすい画面にしたいです。
```

#### 現実的な範囲で考える

AI がたくさんアイデアを出してくれますが、
今回作った API で実現できるものだけを選びます。

### 5.2 画面の設計書作成

#### 現実的な範囲で計画を立てる

全部一度に作るのは無理です。
今回作った API で実現できる範囲だけに絞りましょう。

チャットで依頼：

```text
今回は、実装済みの API だけを使って画面を作りたいです。
機能要件をまとめて、設計書を @docs フォルダに作成してください。
初心者でもわかりやすい内容でお願いします。
```

#### 設計書に書かれること

- **作る機能**：商品登録、商品表示など
- **作らない機能**：商品削除、在庫管理など
- **使える API**：どの機能が使えるか
- **画面の構成**：どんなボタンや入力欄があるか

#### なぜ絞り込むの？

- 確実に完成させるため
- 基本機能をしっかり作るため
- 時間内に達成感を得るため

### 5.3 画面開発でも品質チェックは必須

#### 「画面だからテストしなくていい」は間違い

このプロジェクトでは、画面開発でも品質チェック（TDD）を守ります。

【プロジェクトのルール】

- **必ずテストを先に書く**
- **1つのテストで1つのことだけ確認**
- **Red→Green→Refactor の順番を守る**
- **テストなしのコードは書かない**

#### Part 4で説明済みの通り、Playwright MCPを併用

Part 4で説明した通り、UI開発でもPlaywright MCPを併用してTDDを進めます。
特別な追加説明は不要です。

### 5.4 品質チェックをサボると何が起こる？

#### テストをサボった場合の問題

##### 技術的な問題

- バグが後から見つかる（手戻りが大変）
- 修正時に別の場所が壊れる
- 「動いているかわからない」不安

##### チームでの問題

- 他の人が理解できないコード
- プロジェクトのルール違反
- 将来の修正が困難

##### 正しい考え方

Streamlit のような画面フレームワークでも、
適切な方法でテストを書けます。
AI がその方法を教えてくれるので安心してください！

#### プロの心構え

品質は「時間があるときに」やるものではなく、
「最初から」守るものです。

### 5.5 UI開発もIssue駆動で進める

#### 重要：API開発と同じ手順を守る

UI開発でも、必ず以下の手順を守ってください：

1. **タスク分解**：UI開発を小さなタスクに分解
2. **Issue登録**：GitHubに作業リストを作成
3. **Issue単位で開発**：各Issueごとに開発を進める

#### UI開発のタスク分解を依頼

チャットで以下を送信してください：

```text
@docs/ui-design.md （AIが作成した設計書のファイル名）

この設計書を基に、UI開発のタスクを分解してください。
各タスクは15-30分で完了できる小さな作業にしてください。

例：
- Task 1: Streamlitアプリの基本構造作成
- Task 2: 商品入力フォームの実装
- Task 3: 商品一覧表示の実装
- Task 4: API接続と統合テスト
```

#### タスクをGitHubに登録

タスク内容を確認して良さそうだったら：

```text
ok、GitHubにIssueとして登録してください
```

**重要**：各Issueの作成時に「**Run**」ボタンが表示されたら、内容を確認してクリックしてください。

### 5.6 最初のUI Issueを開始

#### Issue登録が完了したら開発開始

GitHubへの登録が完了したら、最初のUI開発タスクを開始します：

```text
Issue #[番号] を開始してください
```

**注意**：番号は実際にAIが作成したIssue番号を使用してください。

### 5.7 Web UI開発での対話パターン

#### 画面開発特有の確認場面

Web UI開発では、API開発とは異なる確認パターンが出てきます：

##### UI開発でのボタン/アイコンの使い分け

**「Run」ボタン**：新しいファイル作成や機能追加の提案時
**「Accept」ボタン**：既存ファイルの修正や削除の提案時
**「✓」「×」アイコン / 「Accept file」ボタン**：ファイル作成・編集提案時（どちらでもOK）

##### UI開発での指示例

Part 4で説明したPlaywright MCP併用TDDをUI開発でも適用します：

```text
Issue #[番号] をTDDで開始してください。
すべてのテスト段階でPlaywright MCPも併用してください。
```

これだけで十分です。AIが適切にTDDサイクルを実行します。

##### UI設計の確認

**場面例**：

- 「レイアウトはこのような構成でよろしいですか？」
- 「ボタンの配置はここで問題ありませんか？」
- 「画面遷移の流れを確認してください」

**対応方法**：

```text
ok
```

または具体的な要望がある場合：

```text
ボタンをもう少し大きくしてください
```

##### コンポーネント実装の確認

**場面例**：

- 「商品入力フォームを実装します」
- 「商品一覧表示を作成します」

**対応方法**：

画面の部品（コンポーネント）の実装提案には：

```text
そのまま進めてください
```

##### Streamlit特有の設定確認

**場面例**：

- 「ページタイトルを設定しますか？」
- 「サイドバーを使用しますか？」

**対応方法**：

```text
シンプルな構成でお願いします
```

##### UI開発完了時のPR確認とマージ

**AIからの完了報告後**：

1. **PRを確認**：`gh pr view --web`
2. **動作確認**：実際に画面を動かしてテスト
3. **PRマージ**：`gh pr merge --merge`
4. **次へ進行**：「Issue #[次の番号] を開始してください」

#### 各作業の流れ

1. **テストを書く**（こうなってほしいを定義）
2. **最小限の実装**（とりあえず動くように）
3. **改善作業**（きれいで読みやすく）
4. **動作確認**（実際に画面で確認）
5. **保存とレビュー依頼**（GitHub に保存）

#### 見守りポイント

AI がこの順番を守って作業している様子を観察してください。
品質を保ちながら確実に進歩していることが分かります。

#### 時間の使い方

各ステップを飛ばさないことで、
結果的に最短時間で完成します。

### 5.8 UI開発の実践

#### 基本はPart 4と同じTDDアプローチ

UI開発でも、Part 4で説明したTDD+Playwright MCP併用アプローチをそのまま適用します。

#### 各Issueでの指示

```text
Issue #[番号] をTDDで開始してください。
すべてのテスト段階でPlaywright MCPも併用してください。
```

これで、AIが自動的に適切なTDDサイクルを実行します。

### 5.9 Issue管理とタスク完了

#### 各Issueの完了確認

各タスクが完了したら、次のIssueに進む指示をしてください：

```text
Issue #[番号] が完了しました。次の Issue #[次の番号] を開始してください。
```

### 5.10 最終確認用手動テスト（補完的）

#### TDD完了後の追加確認

全てのIssueが完了し、TDDサイクルで品質が保証された後、
最終的なユーザー体験確認として手動テストを実施します。

**Cursor 内のターミナル**で実行：

```bash
# 画面アプリを起動（最終確認用）
cd ui && uv run streamlit run main.py
```

ブラウザで <http://localhost:8501> にアクセスして目視確認してください。

---

## Part 6：Cloud Run デプロイ（10 分）

### クラウド環境で公開しましょう

AIと一緒にプロレベルのクラウドデプロイを体験します。
手動デプロイとMCP（Model Context Protocol）の両方の方法を学習しますが、確実に成功させるため手動デプロイを推奨します。

**重要**: このプロジェクトは最初からCloud Run分離デプロイ対応で設計されています。
`api/` と `ui/` のディレクトリがそれぞれ独立したサービスとしてデプロイされます。

### 6.1 セキュアな認証の準備（2分）

#### Step 1：プロジェクトIDの設定

**Cursor 内のターミナル**で以下を実行します。

```bash
# あなたのGoogle CloudプロジェクトIDを設定
export PROJECT_ID="your-project-id"
gcloud config set project $PROJECT_ID
```

##### プロジェクトIDがわからない場合

```bash
# プロジェクト一覧を表示
gcloud projects list
```

#### Step 2：認証の実行

```bash
# Google Cloudにログイン
gcloud auth application-default login
```

### 6.2 APIデプロイの準備（3分）

#### 重要な注意事項

**Cloud Run環境では相対インポートが機能しません。**
開発環境では動作していても、本番環境で失敗する典型的なパターンです。

#### 必須ファイルを準備

**1. 空の__init__.pyを作成**

```bash
touch api/__init__.py
```

**2. requirements.txtを生成**

```bash
# プロジェクトルートで実行
uv pip compile pyproject.toml --extra api -o api/requirements.txt
```

**3. Procfileを作成**

```bash
echo 'web: gunicorn --bind 0.0.0.0:$PORT --workers 4 --worker-class uvicorn.workers.UvicornWorker main:app' > api/Procfile
```

#### 4. インポートパスを修正（最重要）

**すべての相対インポートを絶対インポートに変更してください：**

- ❌ `from .models import ProductModel`（相対インポート）
- ✅ `from models import ProductModel`（絶対インポート）

**api/main.py** を修正：

```python
# 変更前（これは失敗する）
from .models import ProductModel, ProductResponse
from .storage import ProductStorage

# 変更後（これが正解）
from models import ProductModel, ProductResponse
from storage import ProductStorage
```

### 6.3 デプロイ実行（4分）

#### 方法1：手動デプロイ（推奨）

確実に成功させるため、手動デプロイを推奨します：

```bash
# プロジェクトルートから実行
gcloud run deploy product-api \
  --source ./api \
  --region asia-northeast1 \
  --allow-unauthenticated
```

**デプロイが完了すると、URL（例：https://product-api-xxxxx.a.run.app）が表示されます。**

#### 方法2：MCPデプロイ（代替）

上記の準備を完了後、チャットで以下を送信：

```text
Cloud Run MCPを使って、api/ ディレクトリの商品管理APIをデプロイしてください。
以下の設定でお願いします。

- リージョン: asia-northeast1（東京）
- サービス名: product-api
- 認証なしで公開アクセス可能に設定
```

#### UIのデプロイ（参考）

**注意**: ワークショップの時間制限により、UIデプロイは任意です。

```bash
# UIもデプロイする場合
gcloud run deploy product-ui \
  --source ./ui \
  --region asia-northeast1 \
  --allow-unauthenticated
```

### 6.4 トラブルシューティング

#### よくあるエラーと解決方法

##### ImportError: attempted relative import with no known parent package

**原因**: 相対インポートがCloud Run環境で失敗

**解決方法**: すべてのインポートを絶対インポートに変更

```python
# ❌ 失敗する例
from .models import ProductModel

# ✅ 正しい例  
from models import ProductModel
```

##### Container failed to start on PORT

**原因**: Procfileの`$PORT`環境変数が正しく設定されていない

**解決方法**: Procfileの内容を確認

```bash
# 正しいProcfile
web: gunicorn --bind 0.0.0.0:$PORT --workers 4 --worker-class uvicorn.workers.UvicornWorker main:app
```

##### gunicorn: error: unrecognized arguments

**原因**: Procfileの引数順序が間違っている

**解決方法**: オプションをmain:appの前に配置

```bash
# ❌ 間違った順序
web: gunicorn main:app --bind 0.0.0.0:$PORT

# ✅ 正しい順序
web: gunicorn --bind 0.0.0.0:$PORT main:app
```

#### デバッグ手順

1. **ローカルで動作確認**
   ```bash
   cd api
   uvicorn main:app --reload
   ```

2. **インポートエラーをチェック**
   ```bash
   cd api
   python -c "from models import ProductModel; print('Import OK')"
   ```

3. **ファイル構成を確認**
   ```bash
   ls -la api/
   # __init__.py, main.py, models.py, storage.py, requirements.txt, Procfile
   ```

### 6.5 本番環境での動作確認（1分）

#### デプロイされたAPIの確認

デプロイが成功すると、URLが表示されます。実際に動作を確認しましょう。

##### API の動作確認

**Cursor 内のターミナル**で実行：

```bash
# ヘルスチェック（APIが生きているか確認）
curl https://product-api-xxxxx.a.run.app/health

# 期待される結果
{"status":"healthy"}
```

##### Swagger UIでAPIを試す

ブラウザで以下のAPIのURLを開きます：

```text
https://product-api-xxxxx.a.run.app/docs
```

###### APIでできること

1. **POST /items**：新しい商品を登録
2. **GET /items/{id}**：登録した商品を確認
3. **GET /health**：ヘルスチェック

### 達成したこと

- **Cloud Run デプロイ成功**：本格的なクラウド環境でAPIが動作
- **プロダクション対応**：企業レベルのインフラ構築を体験
- **トラブルシューティング**：実際の開発で発生する問題と解決法を学習
- **絶対インポート**：本番環境での重要な技術的知識を習得

#### 友達に見せよう

URLを友達に送って、あなたが作ったAPIを使ってもらいましょう！
「これ、1.5時間で作ったんだよ」と自慢してもOKです。

**注意**：学習用のアプリなので、個人情報や重要なデータは入力しないよう注意してください。

#### 成功の秘訣

- **ファイル準備の徹底**：__init__.py、requirements.txt、Procfileの確実な作成
- **絶対インポートの統一**：相対インポートは必ず絶対インポートに変更
- **エラーメッセージを読む**：具体的な解決法が含まれている
- **AIとの協力**：困ったときは遠慮なく質問する

プロの開発者も同じようにトラブルシューティングを行います。
これも大切な学習の一部です！

## Part 7：完成とまとめ（5分）

### 本格的な Web アプリが完成しました

AI との協力により、プロ顔負けの開発フローを1.5時間で体験できました。

### 7.1 完成品の確認

#### 最終確認：すべてのIssueがクローズされているか

ワークショップ完了前に、すべてのタスクが完了していることを確認しましょう：

```bash
# 最終的なIssue状態確認
gh issue list --state all

# まだオープンなIssueがある場合は手動クローズ
gh issue close [Issue番号] --comment "ワークショップ完了につき手動クローズ"
```

#### 理想的な最終状態

すべてのIssueが **Closed** になっていることを確認してください：

- ✅ Issue #1: プロジェクトの準備と土台作り → **Closed**
- ✅ Issue #2: APIの動作確認機能 → **Closed**  
- ✅ Issue #3: 商品データの設計図 → **Closed**
- ✅ Issue #4: 新しい商品を登録する機能 → **Closed**
- ✅ Issue #5: 特定の商品をIDで探す機能 → **Closed**

#### おめでとうございます！以下が完成しました

1. **開発環境**：プロ仕様の開発セットアップ
2. **商品管理 API**：データを処理する仕組み
3. **Web 画面**：誰でも使える操作画面
4. **クラウド公開**：インターネット経由でアクセス可能
5. **品質保証**：テストで守られた安全なコード
6. **プロジェクト管理**：GitHubによる完全なタスク管理

#### これって実はすごいこと

- 企業で実際に使われている技術
- プロの開発者が数日かけて行う作業
- 品質とセキュリティを両立した開発フロー

### 7.2 学んだことの振り返り

#### プログラミング初心者がこの学習で体験したこと

##### AI との協力開発

- 「○○がしたい」と日本語で伝える
- AI が技術的な実装を担当
- 人間は方向性とアイデアに集中

##### プロジェクト管理

- 大きな仕事を小さなタスクに分解
- 進捗が目に見える形で管理
- GitHub を使った本格的な管理

##### 品質の高い開発

- テストを先に書く安全な方法
- バグを事前に防ぐ仕組み
- 安心してコードを修正できる環境

##### 本格的な Web アプリ開発

- API（データ処理）の実装
- UI（画面）の実装
- クラウドでの本番環境構築

##### AI ペアプログラミングの威力

- 従来の数十倍の開発速度
- 初心者でもプロ品質のコード
- 複雑な設定も完全自動化

#### 何より大切なこと

プログラミングは特別な才能が必要なものではなく、
AI と協力すれば誰でもできる創造的な活動だということ！

---

## おめでとうございます

### あなたはもうプログラマーです

1.5 時間で、プログラミング未経験から本格的な Web アプリケーションを完成させました。
これは、プロの開発者が実際に行っている本物の開発フローそのものです。

### あなたの成果

- プロ仕様の開発環境を構築
- AI と対話しながらコードを作成
- テスト駆動開発で品質を保証
- GitHub でプロジェクト管理
- クラウドで本番環境を構築
- インターネット経由でアクセスできる Web アプリを公開

### 最も大切なこと

完璧を求めず、AI と協力しながら前進すること。
プログラミングは「知識の暗記」ではなく「AI との協働」です。

### これからも困ったら

- AI に遠慮なく質問
- エラーを恐れずにチャレンジ
- 小さく始めて、少しずつ拡張

### あなたは新しい世界の扉を開きました

Happy Coding!
